{
  "openapi": "3.1.1",
  "info": {
    "title": "IAM Microservice API",
    "description": "Identity & Access Management Microservice API - A comprehensive solution for authentication, authorization, user management, and session handling in a microservices ecosystem.\n\n## Features\n- **Multi-factor Authentication**: Password, OTP (SMS/Email), Social Login\n- **Role-Based Access Control (RBAC)**: User groups and permissions\n- **Attribute-Based Access Control (ABAC)**: Policy-based authorization\n- **Session Management**: JWT tokens with refresh capabilities\n- **User Management**: Registration, profile management, contact handling\n- **Security**: AES-256 encryption for sensitive data\n\n## API Versioning\nThis API follows semantic versioning. Current version: v1.0.0\n\n## Rate Limiting\n- Authentication endpoints: 10 requests/minute per IP\n- Authorization endpoints: 100 requests/minute per user\n- Health check: 1000 requests/minute per IP",
    "version": "1.0.0",
    "contact": {
      "name": "IAM Service Team",
      "email": "iam-service@example.com",
      "url": "https://docs.example.com/iam"
    },
    "license": {
      "name": "MIT",
      "url": "https://opensource.org/licenses/MIT"
    },
    "x-service-info": {
      "service-name": "iam-service",
      "team": "Platform Engineering",
      "repository": "https://github.com/example/iam-service",
      "monitoring": "https://monitoring.example.com/iam",
      "documentation": "https://docs.example.com/iam"
    }
  },
  "servers": [
    {
      "url": "http://localhost:8080/v1/iam",
      "description": "Local Development Server"
    },
    {
      "url": "https://dev-api.example.com/v1/iam",
      "description": "Development Environment"
    },
    {
      "url": "https://qa-api.example.com/v1/iam",
      "description": "Quality Assurance Environment"
    },
    {
      "url": "https://uat-api.example.com/v1/iam",
      "description": "User Acceptance Testing Environment"
    },
    {
      "url": "https://staging-api.example.com/v1/iam",
      "description": "Staging Environment"
    },
    {
      "url": "https://pre-prod-api.example.com/v1/iam",
      "description": "Pre-Production Environment"
    },
    {
      "url": "https://api.example.com/v1/iam",
      "description": "Production Environment"
    }
  ],
  "tags": [
    {
      "name": "Authentication",
      "description": "User authentication and security controls"
    },
    {
      "name": "Authorization / ABAC",
      "description": "Access control and permissions"
    },
    {
      "name": "User Management",
      "description": "Core user identity and profile management"
    },
    {
      "name": "Session Management",
      "description": "User session lifecycle management"
    },
    {
      "name": "Tenant Management",
      "description": "Tenant lifecycle and configuration management"
    },
    {
      "name": "Federation / External IdP",
      "description": "External identity provider federation"
    },
    {
      "name": "Infrastructure / DevOps",
      "description": "Service health, metrics and operational endpoints"
    }
  ],
  "paths": {
    "/api/v1/auth/login": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Authenticate user via username/password. The username must be a valid email address or a registered username.",
        "description": "Authenticate user via username/password. The login process works as follows:\n\n1. **Receive Encrypted Credentials**:\n   - Client sends a POST request with `username` and `password`.\n   - Both fields must be encrypted using AES-256-CBC with the agreed key and IV.\n   - Ciphertext must be base64-encoded.\n\n2. **Decrypt Credentials**:\n   - Backend decrypts the `username` and `password` using the provided key and IV.\n\n3. **Validate Input Format**:\n   - `username` must be a valid email address or a registered username.\n   - `password` must meet complexity requirements (minimum 8 characters, including uppercase, lowercase, number, and special character).\n\n4. **Authenticate User**:\n   - Compare decrypted credentials with stored user records.\n   - If valid, proceed; otherwise return `401 Unauthorized`.\n\n5. **Check Account Status**:\n   - Ensure the account is active and not locked or disabled.\n\n6. **Generate Tokens**:\n   - Issue a JWT access token and a refresh token.\n   - Include user roles, permissions, and attributes in the token payload.\n\n7. **Respond to Client**:\n   - Return a structured JSON containing `status` and `data`:\n     - `status`: Success or failure with business error codes.\n     - `data`: `accessToken`, `refreshToken`, `expiresIn`, `tokenType`, `attributes`, `permissions`.\n\n8. **Audit Logging**:\n   - Log authentication events, including failed and successful logins, for security and compliance.\n\n9. **Error Handling**:\n   - `400`: Invalid input format.\n   - `401`: Unauthorized (invalid credentials).\n   - `409`: Password complexity not met.\n   - `500`: Internal server errors.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              },
              "examples": {
                "success": {
                  "summary": "Valid credentials",
                  "description": "Username and password are correctly encrypted and valid",
                  "value": {
                    "username": "Base64EncryptedUsername==",
                    "password": "Base64EncryptedPassword=="
                  }
                },
                "fail_invalid_format": {
                  "summary": "Invalid input format",
                  "description": "Username or password does not meet expected format",
                  "value": {
                    "username": "invalid_base64",
                    "password": "short"
                  }
                },
                "fail_unauthorized": {
                  "summary": "Invalid credentials",
                  "description": "Username and password are properly encrypted but do not match any user",
                  "value": {
                    "username": "Base64EncryptedWrongUsername==",
                    "password": "Base64EncryptedWrongPassword=="
                  }
                },
                "fail_complexity": {
                  "summary": "Password complexity not met",
                  "description": "Password does not satisfy complexity requirements",
                  "value": {
                    "username": "Base64EncryptedUsername==",
                    "password": "Base64EncryptedSimplePassword=="
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { "$ref": "#/components/schemas/CommonResponse" },
                    "data": { "$ref": "#/components/schemas/TokenDTO" }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "400",
                    "message": "Bad Request",
                    "bizErrorCode": "20001",
                    "bizErrorMessage": "The provided username or password format is invalid."
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid credentials",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "401",
                    "message": "Unauthorized",
                    "bizErrorCode": "20002",
                    "bizErrorMessage": "Invalid username or password."
                  }
                }
              }
            }
          },
          "409": {
            "description": "Conflict - Invalid password format or complexity requirements not met",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "409",
                    "message": "Conflict",
                    "bizErrorCode": "20003",
                    "bizErrorMessage": "Invalid password format or complexity requirements not met."
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "500",
                    "message": "Internal Server Error",
                    "bizErrorCode": "20004",
                    "bizErrorMessage": "An unexpected error occurred."
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/login/mobile": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Authenticate user via mobile number + OTP. The mobile number must be encrypted and accompanied by a valid otpReferenceId.",
        "description": "Authenticate user via mobile number and OTP. The login process works as follows:\n\n1. **Receive Encrypted Mobile Number & OTP Reference**:\n   - Client sends a POST request with `mobileNumber` and `otpReferenceId`.\n   - `mobileNumber` MUST be encrypted using AES-256-CBC with the agreed key and IV and base64-encoded.\n   - `otpReferenceId` is a UUID returned from the OTP request flow.\n\n2. **Decrypt Mobile Number**:\n   - Backend decrypts the `mobileNumber` using the provided key and IV to obtain the plaintext phone number.\n\n3. **Validate Input Format**:\n   - `mobileNumber` plaintext must be a valid phone number (E.164 recommended).\n   - `otpReferenceId` must be a valid UUID and correspond to an issued OTP session.\n\n4. **Verify OTP**:\n   - Lookup OTP by `otpReferenceId` and ensure it was issued for the decrypted mobile number.\n   - Verify OTP code validity, expiry, and that it has not been consumed.\n\n5. **Authenticate or Provision User**:\n   - If the mobile number maps to an existing account, authenticate; otherwise optionally auto-provision per tenant policy.\n   - If authentication fails, return `401 Unauthorized`.\n\n6. **Generate Tokens**:\n   - Issue a JWT access token and a refresh token.\n   - Include user roles, permissions, and attributes in the token payload.\n\n7. **Consume OTP & Audit Logging**:\n   - Mark the OTP as used to prevent replay attacks.\n   - Log authentication events for security and compliance (successful and failed attempts).\n\n8. **Respond to Client**:\n   - Return a structured JSON containing `status` and `data`:\n     - `status`: Success or failure with business error codes.\n     - `data`: `accessToken`, `refreshToken`, `expiresIn`, `tokenType`, `attributes`, `permissions`.\n\n9. **Error Handling**:\n   - `400`: Invalid input format.\n   - `401`: Unauthorized (invalid mobile number or OTP).\n   - `409`: Conflict (OTP expired or already used).\n   - `500`: Internal server errors.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginMobileRequest"
              },
              "examples": {
                "success": {
                  "summary": "Valid mobile number and OTP",
                  "description": "Mobile number is encrypted and OTP is correct",
                  "value": {
                    "mobileNumber": "AES256EncryptedMobileNumber==",
                    "otpReferenceId": "550e8400-e29b-41d4-a716-446655440000"
                  }
                },
                "fail_invalid_format": {
                  "summary": "Invalid input format",
                  "description": "Mobile number encryption or OTP does not meet expected format",
                  "value": {
                    "mobileNumber": "invalid_aes256",
                    "otpReferenceId": "550e8400-e29b-41d4-a716-446655440000"
                  }
                },
                "fail_unauthorized": {
                  "summary": "Invalid credentials",
                  "description": "Encrypted mobile number and OTP do not match any user",
                  "value": {
                    "mobileNumber": "AES256EncryptedWrongMobileNumber==",
                    "otpReferenceId": "550e8400-e29b-41d4-a716-446655440000"
                  }
                },
                "fail_conflict": {
                  "summary": "OTP expired or already used",
                  "description": "The OTP has expired or has already been consumed",
                  "value": {
                    "mobileNumber": "AES256EncryptedMobileNumber==",
                    "otpReferenceId": "550e8400-e29b-41d4-a716-446655440000"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { "$ref": "#/components/schemas/CommonResponse" },
                    "data": { "$ref": "#/components/schemas/TokenDTO" }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "400",
                    "message": "Bad Request",
                    "bizErrorCode": "20011",
                    "bizErrorMessage": "The provided mobile number or OTP format is invalid."
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid credentials",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "401",
                    "message": "Unauthorized",
                    "bizErrorCode": "20012",
                    "bizErrorMessage": "Invalid mobile number or OTP."
                  }
                }
              }
            }
          },
          "409": {
            "description": "Conflict - OTP expired or already used",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "409",
                    "message": "Conflict",
                    "bizErrorCode": "20013",
                    "bizErrorMessage": "OTP has expired or was already used."
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "500",
                    "message": "Internal Server Error",
                    "bizErrorCode": "20014",
                    "bizErrorMessage": "An unexpected error occurred."
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/login/email": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Authenticate user via email + OTP. The email must be encrypted and accompanied by a valid otpReferenceId.",
        "description": "Authenticate user via email and OTP. The login process works as follows:\n\n1. **Receive Encrypted Email & OTP Reference**:\n   - Client sends a POST request with `email` and `otpReferenceId`.\n   - `email` MUST be encrypted using AES-256-CBC with the agreed key and IV and base64-encoded.\n   - `otpReferenceId` is a UUID returned from the OTP request flow.\n\n2. **Decrypt Email**:\n   - Backend decrypts the `email` using the provided key and IV to obtain the plaintext email address.\n\n3. **Validate Input Format**:\n   - `email` plaintext must be a valid email address (RFC 5322 recommended).\n   - `otpReferenceId` must be a valid UUID and correspond to an issued OTP session.\n\n4. **Verify OTP**:\n   - Lookup OTP by `otpReferenceId` and ensure it was issued for the decrypted email.\n   - Verify OTP code validity, expiry, and that it has not been consumed.\n\n5. **Authenticate or Provision User**:\n   - If the email maps to an existing account, authenticate; otherwise optionally auto-provision per tenant policy.\n   - If authentication fails, return `401 Unauthorized`.\n\n6. **Generate Tokens**:\n   - Issue a JWT access token and a refresh token.\n   - Include user roles, permissions, and attributes in the token payload.\n\n7. **Consume OTP & Audit Logging**:\n   - Mark the OTP as used to prevent replay attacks.\n   - Log authentication events for security and compliance (successful and failed attempts).\n\n8. **Respond to Client**:\n   - Return a structured JSON containing `status` and `data`:\n     - `status`: Success or failure with business error codes.\n     - `data`: `accessToken`, `refreshToken`, `expiresIn`, `tokenType`, `attributes`, `permissions`.\n\n9. **Error Handling**:\n   - `400`: Invalid input format.\n   - `401`: Unauthorized (invalid email or OTP).\n   - `409`: Conflict (OTP expired or already used).\n   - `500`: Internal server errors.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginEmailRequest"
              },
              "examples": {
                "success": {
                  "summary": "Valid email and OTP",
                  "description": "Email is encrypted and OTP is correct",
                  "value": {
                    "email": "AES256EncryptedEmail==",
                    "otpReferenceId": "550e8400-e29b-41d4-a716-446655440000"
                  }
                },
                "fail_invalid_format": {
                  "summary": "Invalid input format",
                  "description": "Email encryption or OTP does not meet expected format",
                  "value": {
                    "email": "invalid_aes256",
                    "otpReferenceId": "550e8400-e29b-41d4-a716-446655440000"
                  }
                },
                "fail_unauthorized": {
                  "summary": "Invalid credentials",
                  "description": "Encrypted email and OTP do not match any user",
                  "value": {
                    "email": "AES256EncryptedWrongEmail==",
                    "otpReferenceId": "550e8400-e29b-41d4-a716-446655440000"
                  }
                },
                "fail_conflict": {
                  "summary": "OTP expired or already used",
                  "description": "The OTP has expired or has already been consumed",
                  "value": {
                    "email": "AES256EncryptedEmail==",
                    "otpReferenceId": "550e8400-e29b-41d4-a716-446655440000"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { "$ref": "#/components/schemas/CommonResponse" },
                    "data": { "$ref": "#/components/schemas/TokenDTO" }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "400",
                    "message": "Bad Request",
                    "bizErrorCode": "20021",
                    "bizErrorMessage": "The provided email or OTP format is invalid."
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid credentials",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "401",
                    "message": "Unauthorized",
                    "bizErrorCode": "20022",
                    "bizErrorMessage": "Invalid email or OTP."
                  }
                }
              }
            }
          },
          "409": {
            "description": "Conflict - OTP expired or already used",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "409",
                    "message": "Conflict",
                    "bizErrorCode": "20023",
                    "bizErrorMessage": "OTP has expired or was already used."
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "500",
                    "message": "Internal Server Error",
                    "bizErrorCode": "20024",
                    "bizErrorMessage": "An unexpected error occurred."
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/login/social": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Authenticate user via social provider OAuth. Supports token validation, account linking/provisioning, and token issuance.",
        "description": "Authenticate user via social provider OAuth.\n\n1. **Receive Social Credentials**:\n   - Client sends `provider`, `accessToken`, and `socialId`.\n   - `provider` MUST be one of the supported providers (GOOGLE, FACEBOOK, TWITTER, LINKEDIN).\n\n2. **Validate Access Token with Provider**:\n   - Validate `accessToken` using the provider's token introspection or userinfo endpoint.\n   - Ensure the provider response contains a subject/id that matches the supplied `socialId` and that the token is not expired or revoked.\n\n3. **Validate Input Format**:\n   - `provider` must match supported enum values.\n   - `accessToken` must be present and well-formed for the provider.\n   - `socialId` must conform to provider-specific identifier constraints.\n\n4. **Authenticate, Provision or Link Account**:\n   - If the social account is already linked to a local user, authenticate that user.\n   - If not linked, follow tenant policy: auto-provision a new user or return a linking required response.\n   - Prevent linking conflicts where the social account is already associated with another user (return 409).\n\n5. **Generate Tokens**:\n   - Issue a JWT access token and a refresh token containing user attribute, permissions and attributes.\n   - Apply tenant and security policies (token TTL, scopes, claims) when building tokens.\n\n6. **Account Linking Flows**:\n   - Support explicit linking/unlinking workflows and confirm user consent when binding social identities.\n   - Enforce verification and anti-duplication checks before linking.\n\n7. **Audit Logging & Security Controls**:\n   - Audit successful and failed social authentication and linking events.\n   - Rate-limit provider validation calls and monitor for suspicious activity.\n\n8. **Respond to Client**:\n   - On success return structured JSON with `status` and `data` (see `TokenDTO`).\n   - On provisioning/linking flows return appropriate status and instructions for next steps.\n\n9. **Error Handling**:\n   - `400`: Invalid input format.\n   - `401`: Unauthorized (invalid/expired access token or mismatched socialId).\n   - `409`: Conflict (social account already linked to another user).\n   - `500`: Internal server errors.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginSocialRequest"
              },
              "examples": {
                "google_login": {
                  "summary": "Google OAuth Login",
                  "description": "Authenticate using Google OAuth provider",
                  "value": {
                    "provider": "GOOGLE",
                    "accessToken": "ya29.a0AfH6SMC...",
                    "socialId": "117238947123456789"
                  }
                },
                "facebook_login": {
                  "summary": "Facebook OAuth Login",
                  "description": "Authenticate using Facebook OAuth provider",
                  "value": {
                    "provider": "FACEBOOK",
                    "accessToken": "EAAJZCZA...",
                    "socialId": "117238947123456789"
                  }
                },
                "twitter_login": {
                  "summary": "Twitter OAuth Login",
                  "description": "Authenticate using Twitter OAuth provider",
                  "value": {
                    "provider": "TWITTER",
                    "accessToken": "AAAAAAAAAA...",
                    "socialId": "117238947123456789"
                  }
                },
                "linkedin_login": {
                  "summary": "LinkedIn OAuth Login",
                  "description": "Authenticate using LinkedIn OAuth provider",
                  "value": {
                    "provider": "LINKEDIN",
                    "accessToken": "AQVxyz...",
                    "socialId": "117238947123456789"
                  }
                },
                "invalid_provider": {
                  "summary": "Invalid Provider",
                  "description": "Example of invalid provider request",
                  "value": {
                    "provider": "INVALID",
                    "accessToken": "xyz...",
                    "socialId": "123"
                  }
                },
                "invalid_token": {
                  "summary": "Invalid Access Token",
                  "description": "Example of invalid/expired access token",
                  "value": {
                    "provider": "GOOGLE",
                    "accessToken": "invalid_token",
                    "socialId": "117238947123456789"
                  }
                },
                "conflict_account": {
                  "summary": "Conflicting Account",
                  "description": "Example when social account already linked to another user",
                  "value": {
                    "provider": "GOOGLE",
                    "accessToken": "ya29.a0AfH6SMC...",
                    "socialId": "existing_account_id"
                  }
                },
                "server_error": {
                  "summary": "Server Error",
                  "description": "Example when provider service is unavailable",
                  "value": {
                    "provider": "FACEBOOK",
                    "accessToken": "valid_token_but_service_down",
                    "socialId": "117238947123456789"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { "$ref": "#/components/schemas/CommonResponse" },
                    "data": { "$ref": "#/components/schemas/TokenDTO" }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "400",
                    "message": "Bad Request",
                    "bizErrorCode": "20031",
                    "bizErrorMessage": "The provided input format is invalid."
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid credentials",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "401",
                    "message": "Unauthorized",
                    "bizErrorCode": "20032",
                    "bizErrorMessage": "Invalid credentials."
                  }
                }
              }
            }
          },
          "409": {
            "description": "Conflict - Account already linked",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "409",
                    "message": "Conflict",
                    "bizErrorCode": "20033",
                    "bizErrorMessage": "The account is already linked to another user."
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "500",
                    "message": "Internal Server Error",
                    "bizErrorCode": "20034",
                    "bizErrorMessage": "An unexpected error occurred."
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/login/2fa": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Verify login using external 2FA mechanism.",
        "description": "Verify login using external 2FA mechanism.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/token/introspect": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Check validity and claims of a token.",
        "description": "Check validity and claims of a token.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/token/revoke": {
      "post": {
        "tags": ["Authentication"],
        "summary": "Revoke access/refresh tokens for a session.",
        "description": "Revoke access/refresh tokens for a session.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/profile": {
      "get": {
        "tags": ["User Management"],
        "summary": "Get Current User",
        "description": "Retrieve the profile information of the currently authenticated user.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { "$ref": "#/components/schemas/CommonResponse" },
                    "data": { "$ref": "#/components/schemas/PersonalInfoDTO" }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid input format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "400",
                    "message": "Bad Request",
                    "bizErrorCode": "20041",
                    "bizErrorMessage": "Invalid request parameters."
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Missing or invalid token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "401",
                    "message": "Unauthorized",
                    "bizErrorCode": "20042",
                    "bizErrorMessage": "Authentication token is missing or invalid."
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found - User profile not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "404",
                    "message": "Not Found",
                    "bizErrorCode": "20043",
                    "bizErrorMessage": "User profile not found."
                  }
                }
              }
            }
          },
          "409": {
            "description": "Conflict - Data conflict or inconsistency",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "409",
                    "message": "Conflict",
                    "bizErrorCode": "20044",
                    "bizErrorMessage": "Data conflict or concurrent update detected."
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                },
                "example": {
                  "status": {
                    "code": "500",
                    "message": "Internal Server Error",
                    "bizErrorCode": "20045",
                    "bizErrorMessage": "An unexpected error occurred while processing the request."
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/{id}/profile": {
      "get": {
        "tags": ["User Management"],
        "summary": "Retrieve user profile data.",
        "description": "Retrieve user profile data.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/{id}/attributes": {
      "post": {
        "tags": ["User Management"],
        "summary": "Assign attributes to a user (role, department, etc.).",
        "description": "Assign attributes to a user (role, department, etc.).",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": ["User Management"],
        "summary": "Retrieve attributes assigned to a specific user.",
        "description": "Retrieve attributes assigned to a specific user.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["User Management"],
        "summary": "Remove attributes from a user.",
        "description": "Remove attributes from a user.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/{id}/dynamic-groups": {
      "get": {
        "tags": ["User Management"],
        "summary": "Retrieve dynamic groups assigned based on attributes.",
        "description": "Retrieve dynamic groups assigned based on attributes.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/sessions/validate": {
      "post": {
        "tags": ["Session Management"],
        "summary": "Validate user session or access token.",
        "description": "Validate user session or access token.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/sessions/refresh": {
      "post": {
        "tags": ["Session Management"],
        "summary": "Generate a new access token using refresh.",
        "description": "Generate a new access token using refresh.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/sessions/logout": {
      "post": {
        "tags": ["Session Management"],
        "summary": "Logout user and invalidate active session.",
        "description": "Logout user and invalidate active session.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/federation/idp": {
      "post": {
        "tags": ["Federation / External IdP"],
        "summary": "Register new external IdP (SAML/OIDC).",
        "description": "Register new external IdP (SAML/OIDC).",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/federation/idp/{id}": {
      "put": {
        "tags": ["Federation / External IdP"],
        "summary": "Update IdP configuration.",
        "description": "Update IdP configuration.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Federation / External IdP"],
        "summary": "Remove IdP configuration.",
        "description": "Remove IdP configuration.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": ["Federation / External IdP"],
        "summary": "Retrieve IdP details.",
        "description": "Retrieve IdP details.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/federation/jit-provision": {
      "post": {
        "tags": ["Federation / External IdP"],
        "summary": "Auto-provision users on first login from IdP.",
        "description": "Auto-provision users on first login from IdP.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/federation/claim-mapping": {
      "post": {
        "tags": ["Federation / External IdP"],
        "summary": "Map external IdP claims to internal user attributes.",
        "description": "Map external IdP claims to internal user attributes.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/logs/auth": {
      "post": {
        "tags": ["Infrastructure / DevOps"],
        "summary": "Log authentication and security events.",
        "description": "Log authentication and security events.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/logs/auth/failed": {
      "get": {
        "tags": ["Infrastructure / DevOps"],
        "summary": "Retrieve list of failed login attempts.",
        "description": "Retrieve list of failed login attempts.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/alerts/security": {
      "post": {
        "tags": ["Infrastructure / DevOps"],
        "summary": "Send security-related notifications or alerts.",
        "description": "Send security-related notifications or alerts.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/mq/publish": {
      "post": {
        "tags": ["Infrastructure / DevOps"],
        "summary": "Publish event to message queue / event bus.",
        "description": "Publish event to message queue / event bus.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/mq/consume": {
      "get": {
        "tags": ["Infrastructure / DevOps"],
        "summary": "Retrieve events from message queue / event bus.",
        "description": "Retrieve events from message queue / event bus.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/authorize/abac": {
      "post": {
        "tags": ["Authorization / ABAC"],
        "summary": "ABAC Authorization Decision",
        "description": "Evaluate attribute-based access control (ABAC) policies to determine if a given action is permitted for a subject on a resource.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/authorize/policy": {
      "post": {
        "tags": ["Authorization / ABAC"],
        "summary": "Policy-based Authorization",
        "description": "Evaluate custom policies for authorization decisions based on supplied context and policy rules.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/policies": {
      "post": {
        "tags": ["Authorization / ABAC"],
        "summary": "Create Policy",
        "description": "Create a new ABAC policy definition for access control.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/policies/{id}": {
      "get": {
        "tags": ["Authorization / ABAC"],
        "summary": "Get Policy Details",
        "description": "Retrieve the details of a specific ABAC policy by its identifier.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["Authorization / ABAC"],
        "summary": "Update Policy",
        "description": "Update the definition or rules of an existing ABAC policy.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Authorization / ABAC"],
        "summary": "Delete Policy",
        "description": "Remove an ABAC policy from the system.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/policies/{id}/versions": {
      "get": {
        "tags": ["Authorization / ABAC"],
        "summary": "List Policy Versions",
        "description": "Retrieve all versions of a specific ABAC policy.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Authorization / ABAC"],
        "summary": "Create Policy Version",
        "description": "Create a new version of an existing ABAC policy.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/attributes": {
      "post": {
        "tags": ["Authorization / ABAC"],
        "summary": "Create Attribute",
        "description": "Create a new attribute for use in ABAC policies.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": ["Authorization / ABAC"],
        "summary": "List Attributes",
        "description": "Retrieve all ABAC attributes defined in the system.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/attributes/{id}": {
      "put": {
        "tags": ["Authorization / ABAC"],
        "summary": "Update Attribute",
        "description": "Update the definition or value of an existing ABAC attribute.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Authorization / ABAC"],
        "summary": "Delete Attribute",
        "description": "Remove an attribute from the ABAC system.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/attributes/groups": {
      "post": {
        "tags": ["Authorization / ABAC"],
        "summary": "Create Attribute Group",
        "description": "Create a new group of attributes for ABAC policy grouping.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/attributes/groups/{id}": {
      "get": {
        "tags": ["Authorization / ABAC"],
        "summary": "Get Attribute Group Details",
        "description": "Retrieve details of a specific attribute group.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["Authorization / ABAC"],
        "summary": "Update Attribute Group",
        "description": "Update the definition of an existing attribute group.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Authorization / ABAC"],
        "summary": "Delete Attribute Group",
        "description": "Remove an attribute group from the ABAC system.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/users": {
      "get": {
        "tags": ["User Management"],
        "summary": "List Users",
        "description": "Retrieve a paginated list of users.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { "$ref": "#/components/schemas/CommonResponse" },
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/PersonalInfoDTO"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["User Management"],
        "summary": "Create User",
        "description": "Register a new user account.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/users/{userId}": {
      "get": {
        "tags": ["User Management"],
        "summary": "Get User Details",
        "description": "Retrieve details for a specific user.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["User Management"],
        "summary": "Update User",
        "description": "Update the profile information of a user.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["User Management"],
        "summary": "Delete User",
        "description": "Remove a user account from the system.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/sessions": {
      "get": {
        "tags": ["Session Management"],
        "summary": "List Active Sessions",
        "description": "Retrieve a list of all active user sessions.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/sessions/{sessionId}": {
      "delete": {
        "tags": ["Session Management"],
        "summary": "Invalidate Session",
        "description": "Terminate a specific active user session.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/federation/external-idp": {
      "get": {
        "tags": ["Federation / External IdP"],
        "summary": "List External IdPs",
        "description": "Retrieve a list of configured external identity providers.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Federation / External IdP"],
        "summary": "Add External IdP",
        "description": "Configure and add a new external identity provider.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/federation/external-idp/{idpId}": {
      "get": {
        "tags": ["Federation / External IdP"],
        "summary": "Get External IdP Details",
        "description": "Retrieve details for a specific external identity provider.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["Federation / External IdP"],
        "summary": "Update External IdP",
        "description": "Update the configuration of an external identity provider.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Federation / External IdP"],
        "summary": "Delete External IdP",
        "description": "Remove an external identity provider configuration.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/infrastructure/health": {
      "get": {
        "tags": ["Infrastructure / DevOps"],
        "summary": "Health Check",
        "description": "Check the health status of the IAM service.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    },
    "/infrastructure/metrics": {
      "get": {
        "tags": ["Infrastructure / DevOps"],
        "summary": "Service Metrics",
        "description": "Retrieve operational metrics for the IAM service.",
        "responses": {
          "200": {
            "description": "Success",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommonResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "security": [
    {
      "BearerAuth": []
    }
  ],
  "x-microservice-info": {
    "service-name": "iam-service",
    "version": "1.0.0",
    "team": "Platform Engineering",
    "repository": "https://github.com/example/iam-service",
    "documentation": "https://docs.example.com/iam",
    "monitoring": "https://monitoring.example.com/iam",
    "health-check": "/api/health",
    "metrics": "/api/metrics",
    "dependencies": [
      {
        "name": "postgresql",
        "type": "database",
        "version": "14+"
      },
      {
        "name": "redis",
        "type": "cache",
        "version": "6+"
      },
      {
        "name": "notification-service",
        "type": "microservice",
        "version": "1.0.0"
      }
    ],
    "deployment": {
      "environment": "kubernetes",
      "replicas": 3,
      "resources": {
        "cpu": "500m",
        "memory": "1Gi"
      }
    }
  },
  "components": {
    "schemas": {
      "CommonResponse": {
        "type": "object",
        "properties": {
          "code": {
            "type": "integer"
          },
          "message": {
            "type": "string"
          },
          "bizErrorCode": {
            "type": "string"
          },
          "bizErrorMessage": {
            "type": "string"
          }
        },
        "required": ["code", "message", "bizErrorCode", "bizErrorMessage"]
      },
      "TokenDTO": {
        "type": "object",
        "description": "JWT token information for user authentication and authorization",
        "properties": {
          "accessToken": {
            "type": "string",
            "minLength": 100,
            "maxLength": 2000,
            "pattern": "^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+$",
            "description": "JWT access token for API authentication",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c",
            "x-data-dictionary": {
              "field-type": "authentication-token",
              "business-meaning": "Bearer token for API access authorization",
              "data-lineage": "Generated by IAM service after successful authentication",
              "sensitivity": "highly-sensitive",
              "retention-policy": "expires-after-token-lifetime",
              "encryption-required": true,
              "token-claims": ["sub", "iat", "exp", "roles", "permissions"]
            }
          },
          "expiresIn": {
            "type": "integer",
            "minimum": 60,
            "maximum": 86400,
            "description": "Token expiration time in seconds (1 minute to 24 hours)",
            "example": 3600,
            "x-data-dictionary": {
              "field-type": "duration-data",
              "business-meaning": "Token validity period for security control",
              "data-lineage": "Calculated based on security policy and user preferences",
              "sensitivity": "internal",
              "retention-policy": "not-applicable",
              "business-rules": [
                "Default: 1 hour",
                "Max: 24 hours",
                "Min: 1 minute"
              ]
            }
          },
          "tokenType": {
            "type": "string",
            "enum": ["Bearer"],
            "default": "Bearer",
            "description": "Token type, always 'Bearer' for JWT tokens",
            "example": "Bearer",
            "x-data-dictionary": {
              "field-type": "constant-value",
              "business-meaning": "OAuth 2.0 token type specification",
              "data-lineage": "Fixed value per OAuth 2.0 standard",
              "sensitivity": "public",
              "retention-policy": "not-applicable"
            }
          },
          "refreshToken": {
            "type": "string",
            "format": "uuid",
            "description": "Refresh token UUID for obtaining new access tokens",
            "example": "550e8400-e29b-41d4-a716-446655440000",
            "x-data-dictionary": {
              "field-type": "refresh-token",
              "business-meaning": "Long-lived token for obtaining new access tokens",
              "data-lineage": "Generated by IAM service during token issuance",
              "sensitivity": "highly-sensitive",
              "retention-policy": "expires-after-refresh-lifetime",
              "encryption-required": true,
              "business-rules": [
                "Valid for 30 days",
                "Single-use per access token"
              ]
            }
          },
          "attributes": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 3,
              "maxLength": 50,
              "pattern": "^[A-Z_]+$"
            },
            "uniqueItems": true,
            "maxItems": 20,
            "description": "List of user attributes",
            "example": ["USER-GROUP", "POLICY", "ATTRIBUTES"],
            "x-data-dictionary": {
              "field-type": "role-list",
              "business-meaning": "User roles for role-based access control",
              "data-lineage": "Assigned by administrators or derived from user groups",
              "sensitivity": "internal",
              "retention-policy": "permanent",
              "business-rules": [
                "Must be predefined roles",
                "Case-sensitive",
                "Uppercase only"
              ]
            }
          },
          "permissions": {
            "type": "array",
            "items": {
              "type": "string",
              "minLength": 5,
              "maxLength": 100,
              "pattern": "^[A-Z_]+:[A-Z_]+$"
            },
            "uniqueItems": true,
            "maxItems": 100,
            "description": "List of user permissions in format 'RESOURCE:ACTION'",
            "example": ["USER:READ", "PROFILE:WRITE", "ADMIN:DELETE"],
            "x-data-dictionary": {
              "field-type": "permission-list",
              "business-meaning": "Granular permissions for fine-grained access control",
              "data-lineage": "Derived from roles and policies",
              "sensitivity": "internal",
              "retention-policy": "permanent",
              "business-rules": [
                "Format: RESOURCE:ACTION",
                "Must be predefined permissions"
              ]
            }
          }
        },
        "required": ["accessToken", "expiresIn", "tokenType"],
        "additionalProperties": false,
        "x-data-dictionary": {
          "schema-purpose": "Authentication token management",
          "business-domain": "Authentication & Authorization",
          "data-classification": "Authentication Data",
          "compliance-requirements": ["OAuth 2.0", "JWT", "PCI-DSS"],
          "update-frequency": "High",
          "access-patterns": ["Read-heavy", "Frequent updates"],
          "security-considerations": [
            "Token rotation",
            "Secure storage",
            "Audit logging"
          ]
        }
      },
      "PersonalInfoDTO": {
        "type": "object",
        "description": "Personal information DTO for user profiles (camelCase fields).",
        "properties": {
          "sid": {
            "type": "string",
            "format": "uuid",
            "description": "System identifier for the person",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "prefixName": {
            "type": "string",
            "minLength": 1,
            "maxLength": 4,
            "description": "Name prefix or title (e.g., Mr, Mrs, Dr)",
            "example": "Dr"
          },
          "firstName": {
            "type": "string",
            "minLength": 1,
            "maxLength": 128,
            "description": "Given name",
            "example": "John"
          },
          "middleName": {
            "type": "string",
            "minLength": 0,
            "maxLength": 128,
            "description": "Middle name(s)",
            "example": "Michael"
          },
          "lastName": {
            "type": "string",
            "minLength": 1,
            "maxLength": 128,
            "description": "Family name / surname",
            "example": "Doe"
          },
          "nickName": {
            "type": "string",
            "minLength": 0,
            "maxLength": 32,
            "description": "Preferred or informal name",
            "example": "Johnny"
          },
          "gender": {
            "type": "string",
            "enum": ["MALE", "FEMALE", "NON_BINARY", "UNSPECIFIED", "OTHER"],
            "description": "Gender classification",
            "example": "MALE"
          },
          "dateOfBirth": {
            "type": "string",
            "format": "date",
            "description": "Date of birth (YYYY-MM-DD)",
            "example": "1980-01-01"
          }
        },
        "required": ["sid", "firstName", "lastName"],
        "additionalProperties": false,
        "x-data-dictionary": {
          "field-purpose": "User personal identity information",
          "sensitivity": "personal",
          "retention-policy": "permanent",
          "business-rules": [
            "sid must be a valid UUID",
            "firstName and lastName are required",
            "dateOfBirth must follow ISO 8601 date format"
          ]
        }
      },
      "LoginRequest": {
        "type": "object",
        "description": "User login request payload. The username and password properties MUST contain AES-256 encrypted ciphertexts (see x-encryption for spec). Ciphertexts MUST be base64-encoded.",
        "properties": {
          "username": {
            "type": "string",
            "description": "Base64-encoded AES-256-CBC ciphertext of the username (plaintext UTF-8). Encrypt with agreed key and iv before sending.",
            "pattern": "^[A-Za-z0-9+/]+={0,2}$",
            "example": "z0Fh3v...base64..."
          },
          "password": {
            "type": "string",
            "description": "Base64-encoded AES-256-CBC ciphertext of the password (plaintext UTF-8). Encrypt with agreed key and iv before sending.",
            "pattern": "^[A-Za-z0-9+/]+={0,2}$",
            "example": "Y2FtcGx...base64..."
          }
        },
        "required": ["username", "password"],
        "additionalProperties": false,
        "x-encryption": {
          "algorithm": "AES-256-CBC",
          "key-length-bits": 256,
          "iv-length-bytes": 16,
          "ciphertext-encoding": "base64",
          "padding": "PKCS#7 (or PKCS#5 equivalently for block size 16)",
          "key-management": "Key material MUST be provisioned/rotated out-of-band and referenced via encryption.keyId. Do NOT include raw keys in requests.",
          "security-notes": [
            "Use secure random IV per encryption operation",
            "Do not reuse IV with same key for different plaintexts",
            "Use authenticated encryption (e.g., AES-GCM) if possible; if using CBC, ensure integrity via HMAC or equivalent"
          ]
        }
      },
      "LoginMobileRequest": {
        "type": "object",
        "description": "User mobile login request payload. The phoneNumber and otpReferenceId properties MUST contain AES-256 encrypted ciphertexts (see x-encryption for spec). Ciphertexts MUST be base64-encoded.",
        "properties": {
          "phoneNumber": {
            "type": "string",
            "description": "Base64-encoded AES-256-CBC ciphertext of the phone number (plaintext UTF-8). Encrypt with agreed key and iv before sending.",
            "pattern": "^[A-Za-z0-9+/]+={0,2}$",
            "example": "bXlQaG9uZ...base64..."
          },
          "otpReferenceId": {
            "type": "string",
            "format": "uuid",
            "description": "UUID reference from OTP request for validation",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          }
        },
        "required": ["phoneNumber", "otpReferenceId"],
        "additionalProperties": false,
        "x-encryption": {
          "algorithm": "AES-256-CBC",
          "key-length-bits": 256,
          "iv-length-bytes": 16,
          "ciphertext-encoding": "base64",
          "padding": "PKCS#7 (or PKCS#5 equivalently for block size 16)",
          "key-management": "Key material MUST be provisioned/rotated out-of-band and referenced via encryption.keyId. Do NOT include raw keys in requests.",
          "security-notes": [
            "Use secure random IV per encryption operation",
            "Do not reuse IV with same key for different plaintexts",
            "Use authenticated encryption (e.g., AES-GCM) if possible; if using CBC, ensure integrity via HMAC or equivalent"
          ]
        }
      },
      "LoginEmailRequest": {
        "type": "object",
        "description": "User email login request payload. The email and otpReferenceId properties MUST contain AES-256 encrypted ciphertexts (see x-encryption for spec). Ciphertexts MUST be base64-encoded.",
        "properties": {
          "email": {
            "type": "string",
            "description": "Base64-encoded AES-256-CBC ciphertext of the email address (plaintext UTF-8). Encrypt with agreed key and iv before sending.",
            "pattern": "^[A-Za-z0-9+/]+={0,2}$",
            "example": "bXlFbWFpbA...base64..."
          },
          "otpReferenceId": {
            "type": "string",
            "format": "uuid",
            "description": "UUID reference from OTP request for validation",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          }
        },
        "required": ["email", "otpReferenceId"],
        "additionalProperties": false,
        "x-encryption": {
          "algorithm": "AES-256-CBC",
          "key-length-bits": 256,
          "iv-length-bytes": 16,
          "ciphertext-encoding": "base64",
          "padding": "PKCS#7 (or PKCS#5 equivalently for block size 16)",
          "key-management": "Key material MUST be provisioned/rotated out-of-band and referenced via encryption.keyId. Do NOT include raw keys in requests.",
          "security-notes": [
            "Use secure random IV per encryption operation",
            "Do not reuse IV with same key for different plaintexts",
            "Use authenticated encryption (e.g., AES-GCM) if possible; if using CBC, ensure integrity via HMAC or equivalent"
          ]
        }
      },
      "LoginSocialRequest": {
        "type": "object",
        "description": "User social login request payload.",
        "properties": {
          "provider": {
            "type": "string",
            "enum": ["GOOGLE", "FACEBOOK", "TWITTER", "LINKEDIN"],
            "description": "Social identity provider name",
            "example": "google"
          },
          "accessToken": {
            "type": "string",
            "description": "Access token obtained from the social identity provider",
            "example": "ya29.a0AfH6SMC..."
          },
          "socialId": {
            "type": "string",
            "description": "Unique identifier of the user in the social provider (provider-specific user id / sub).",
            "example": "117238947123456789",
            "minLength": 1,
            "maxLength": 200
          }
        },
        "required": ["provider", "accessToken", "socialId"],
        "additionalProperties": false
      }
    },
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "x-data-dictionary": {
      "version": "1.0.0",
      "last-updated": "2024-01-15T10:30:00Z",
      "description": "Comprehensive data dictionary for IAM Microservice API",
      "data-classifications": {
        "public": "Data that can be freely shared",
        "internal": "Data for internal use only",
        "personal": "Personal information requiring GDPR compliance",
        "sensitive": "Sensitive data requiring encryption",
        "highly-sensitive": "Highly sensitive data requiring strong encryption and audit"
      },
      "field-types": {
        "primary-key": "Unique identifier for database records",
        "business-key": "Human-readable business identifier",
        "personal-data": "Personal information about individuals",
        "authentication-data": "Data used for user authentication",
        "authentication-token": "JWT or similar authentication tokens",
        "refresh-token": "Long-lived token for token refresh",
        "reference-data": "Reference information linking related data",
        "session-identifier": "Unique identifier for user sessions",
        "duration-data": "Time-based data (durations, intervals)",
        "constant-value": "Fixed values that don't change",
        "role-list": "List of user roles",
        "permission-list": "List of user permissions",
        "audit-data": "Data for audit and compliance tracking"
      },
      "business-domains": {
        "Identity Management": "Core user identity and profile management",
        "Authentication & Security": "User authentication and security controls",
        "Authorization": "Access control and permissions",
        "Session Management": "User session lifecycle management",
        "Audit & Compliance": "Audit trails and compliance tracking"
      },
      "compliance-frameworks": {
        "GDPR": "General Data Protection Regulation",
        "CCPA": "California Consumer Privacy Act",
        "SOX": "Sarbanes-Oxley Act",
        "PCI-DSS": "Payment Card Industry Data Security Standard",
        "HIPAA": "Health Insurance Portability and Accountability Act",
        "OAuth 2.0": "OAuth 2.0 Authorization Framework",
        "JWT": "JSON Web Token standard"
      },
      "retention-policies": {
        "permanent": "Data retained permanently",
        "7-years-after-deletion": "Data retained for 7 years after user deletion",
        "expires-after-5-minutes": "Data expires after 5 minutes",
        "expires-after-10-minutes": "Data expires after 10 minutes",
        "expires-after-session-end": "Data expires when session ends",
        "expires-after-token-lifetime": "Data expires with token lifetime",
        "expires-after-refresh-lifetime": "Data expires with refresh token lifetime",
        "not-applicable": "Retention policy not applicable"
      },
      "data-lineage-patterns": {
        "Generated by IAM service during user creation": "System-generated during user registration",
        "Provided by user during registration": "User-provided during account creation",
        "Assigned by business rules during user creation": "Business logic assigned identifiers",
        "Generated by OTP service and sent to user's device": "OTP service generated codes",
        "Generated by OTP service during code generation": "OTP service reference codes",
        "Generated by IAM service during OTP request": "IAM service session tracking",
        "Generated by IAM service after successful authentication": "Post-authentication token generation",
        "Calculated based on security policy and user preferences": "Policy-based calculations",
        "Fixed value per OAuth 2.0 standard": "Standards-compliant fixed values",
        "Generated by IAM service during token issuance": "Token issuance process",
        "Assigned by administrators or derived from user groups": "Administrative role assignment",
        "Derived from roles and policies": "Policy-based permission derivation"
      },
      "access-patterns": {
        "Read-heavy": "Frequent read operations, infrequent writes",
        "Write-once": "Data written once, rarely updated",
        "Read-once": "Data read once, then discarded",
        "Short-lived": "Data with short lifecycle",
        "Occasional updates": "Infrequent update operations",
        "Frequent updates": "Regular update operations"
      },
      "security-considerations": {
        "encryption-required": "Data must be encrypted at rest and in transit",
        "token-rotation": "Tokens must be rotated regularly",
        "secure-storage": "Data must be stored securely",
        "audit-logging": "All access must be logged for audit",
        "access-control": "Strict access control required",
        "data-masking": "Sensitive data must be masked in logs"
      },
      "business-rules": {
        "Default: 1 hour": "Default token expiration time",
        "Max: 24 hours": "Maximum token expiration time",
        "Min: 1 minute": "Minimum token expiration time",
        "Valid for 30 days": "Refresh token validity period",
        "Single-use per access token": "Refresh token usage rule",
        "Must be predefined roles": "Role validation rule",
        "Case-sensitive": "Case sensitivity requirement",
        "Uppercase only": "Uppercase format requirement",
        "Format: RESOURCE:ACTION": "Permission format specification",
        "Must be predefined permissions": "Permission validation rule"
      },
      "schema-evolution": {
        "versioning-strategy": "Semantic versioning with backward compatibility",
        "deprecation-policy": "Fields deprecated for 2 major versions before removal",
        "breaking-changes": "Require major version increment",
        "non-breaking-changes": "Minor version increment allowed",
        "field-lifecycle": {
          "introduced": "Field added in version X.Y.Z",
          "deprecated": "Field marked for removal in version X+2.Y.Z",
          "removed": "Field removed in version X+2.Y.Z"
        }
      },
      "extensibility-patterns": {
        "additional-properties": "Use additionalProperties: false for strict schemas",
        "custom-fields": "Use x-custom-* extensions for non-standard fields",
        "polymorphism": "Use allOf/oneOf/anyOf for flexible object composition",
        "conditional-fields": "Use if/then/else for conditional field requirements",
        "dynamic-enums": "Use x-enum-values for dynamically populated enums"
      },
      "data-quality-rules": {
        "required-fields": "All required fields must be present and non-null",
        "format-validation": "All fields must match specified format patterns",
        "length-constraints": "String fields must be within min/max length limits",
        "enum-validation": "Enum fields must contain only predefined values",
        "pattern-matching": "String fields must match specified regex patterns",
        "range-validation": "Numeric fields must be within min/max value ranges"
      },
      "api-versioning": {
        "current-version": "v1.0.0",
        "supported-versions": ["v1.0.0"],
        "version-strategy": "URL path versioning (/v1/iam/)",
        "deprecation-notice": "Minimum 6 months notice for API version deprecation",
        "migration-guide": "https://docs.example.com/iam/migration-guide"
      }
    }
  }
}
